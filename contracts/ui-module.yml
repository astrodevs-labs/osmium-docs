asyncapi: '2.6.0'
info:
  title: UI Module
  version: '1.0.0'
  description: |
    Description ahah
  contact:
    name: Contact Name
    email: email@company.com

servers:
  production:
    url: ui.prod
    protocol: cpp
    description: server description
  dev:
    url: ui.dev
    protocol: cpp
    description: server description

defaultContentType: application/json

channels:
  # Has it to be different than a component state event ? 
  ComponentTreeUpdate:
    description: Events about modifying current component tree.
    subscribe:
      summary: Component Added or Deleted
      operationId: treeUpdate
      message:
        $ref: '#/components/messages/ComponentUpdatePayload'

  NewScaffoldEvent:
    description: Events about resetting the component tree.
    publish:
      summary: Sending new scaffold
      operationId: newScaffold
      message:
        $ref: '#/components/messages/NewScaffoldPayload'

  FrontStateEvent:
    description: Events from the front end user (See front-module).
    subscribe:
      summary: A state changed from the client input.
      operationId: stateEvent
      message:
        $ref: '#/components/messages/StateEventPayload'
  
  FrontConnectedEvent:
    description: Events on connection with front-end (See front-module).
    subscribe:
      summary: A payload containing the connection information (here used to trigger first scaffold building)
      operationId: frontConnectedEvent
      message:
        $ref: '#/components/messages/ConnectionPayload'

  FrontTreeUpdate:
    description: Events to send to front when tree changed (See front-module).
    publish:
      summary: Sending Event to Front
      operationId: treeUpdateEvent
      message:
        $ref: '#/components/messages/NewLayoutPayload'
  
  FrontScaffoldUpdate:
    description: Events to send to front when a new scaffold has to be rendered (See front-module).
    publish:
      summary: Sending scaffold to Front
      operationId: scaffoldEvent
      message:
        $ref: '#/components/messages/NewScaffoldPayload'



components:
  messages:

    ComponentUpdatePayload:
      title: Component Payload
      summary: The components data received from other modules by the UI Module
      schemaFormat: application/vnd.aai.asyncapi;version=2.6.0
      payload:
        $ref: 'payloads/component_update.yml'

    NewLayoutPayload:
      title: Front Component Payload
      summary: The optimized components data to send to the front
      schemaFormat: application/vnd.aai.asyncapi;version=2.6.0
      payload:
        $ref: 'payloads/component_update.yml'
  
    NewScaffoldPayload:
      title: Scaffold Data Payload
      summary: A Scaffold structure data to build UI
      schemaFormat: application/vnd.aai.asyncapi;version=2.6.0
      payload:
        $ref: 'payloads/new_scaffold_req.yml'
  
    StateEventPayload:
      title: State Event Payload
      summary: | 
        Generic component state event payload from the client.
        To be formatted as a specific payload to broadcast to modules.
      schemaFormat: application/vnd.aai.asyncapi;version=2.6.0
      payload:
        $ref: 'payloads/component_state.yml'

    ConnectionPayload:
      title: Connection Payload
      summary: Payload with the connection information.
      schemaFormat: application/vnd.aai.asyncapi;version=2.6.0
      payload:
        $ref: 'payloads/connection_info.yml'
